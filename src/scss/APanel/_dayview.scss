:root {
   /* Dimensiuni / layout */
   --slot-h: 30px;
   --hours-col-w: 60px;
   --group-gap: 12px;
   --cols: 1;
   --colw: 120px;

   /* Culori evenimente (light) */
   --event-default: #616033;
   --event-red: hsl(0 70% 40%);
   --event-orange: hsl(30 70% 40%);
   --event-yellow: hsl(54 100% 33%);
   --event-green: hsl(130 70% 23%);
   --event-blue: hsl(210 70% 40%);
   --event-indigo: hsl(255 70% 33%);
   --event-purple: hsl(285 66% 32%);
   --event-pink: hsl(330 68% 38%);
}

.darkmode {
   /* Culori evenimente (dark) */
   --event-default: #f1f8c0d7;
   --event-red: hsl(0 100% 87%);
   --event-orange: hsl(30 100% 80%);
   --event-yellow: hsl(54 95% 76%);
   --event-green: hsl(130 65% 76%);
   --event-blue: hsl(210 90% 74%);
   --event-indigo: hsl(255 98% 83%);
   --event-purple: hsl(285 100% 84%);
   --event-pink: hsl(330 96% 81%);
}

/* ===========================================================
   DAYVIEW
   =========================================================== */
/* lanțul de flex pe verticală */
html,
body,
#root {
   height: 100%;
}

/* scoatem absolute-ul care rupe layout-ul */
.rbc-time-view,
.rbc-month-view,
.rbc-agenda-view,
.dayview {
   position: static !important; /* <-- în loc de absolute */
   display: flex !important;
   flex-direction: column !important;
   flex: 1 1 0 !important;
   min-height: 0 !important;
}

.calendar__frame.rbc-calendar {
   display: flex !important;
   flex-direction: column !important;
   flex: 1 1 0 !important;
   min-height: 0 !important;
}
html,
body,
#root,
.App {
   min-height: 100svh;
   height: auto;
}

/* Zona ta principală (dacă ai header fix de 48px, ajustează) */
.main {
   display: flex;
   flex-direction: column;
   min-height: calc(100svh - 48px); /* umple restul ecranului */
   height: auto; /* poate crește peste */
}

/* Containerul calendarului */
.calendar {
   display: flex;
   flex-direction: column;
   flex: 1 1 auto;
   min-height: 0; /* important în flex ca să lase copilul să-și calculeze înălțimea */
   height: auto;
}

/* Frame-ul RBC */
.calendar__frame.rbc-calendar {
   display: flex !important;
   flex-direction: column !important;
   flex: 1 1 0 !important; /* ia toată înălțimea disponibilă din .calendar */
   min-height: 0 !important; /* nu limita */
   height: auto !important; /* NU 100% */
   box-sizing: border-box;
   overflow: hidden;
}

.dayview {
   background: var(--black-s) !important;
   color: var(--white-p);
   /* ---------- Header + Toolbar ---------- */
   &__header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 0 12px 12px 12px;
   }
   &__header-left {
      min-width: 250px;
   }

   &__toolbar {
      display: flex;
      align-items: center;
      gap: 6px;
      height: 100%;

      .dv-search__input {
         width: 100%;
         height: 100%;
         padding: 12px 16px;
         border-radius: 32px;
         background: var(--black-p);
         color: var(--white-p);
         font-size: 14px;
         outline: none;
      }
      .dv-search__input::placeholder {
         color: var(--muted);
      }

      .dv-btn {
         height: 100%;
         padding: 13px;
         border-radius: 18px;
         background: var(--black-p);
         color: var(--white-p);
         cursor: pointer;
         transition: all var(--elastic-f), background var(--classic-f);
         svg {
            height: 20px;
            width: 20px;
            transition: var(--elastic-s);
         }
      }
      .dv-btn:hover {
         border-radius: 10px;
         background: var(--accent-l);
         color: var(--accent-d);
         &.reset {
            svg {
               rotate: 270deg;
            }
         }
      }
      .dv-btn:active {
         border-radius: 18px;
         scale: 0.92;
      }
      .dv-btn--ghost {
         padding: 12px 16px;
         border-radius: 10px;
         pointer-events: none;
      }
   }

   /* ---------- Scroller / Track ---------- */
   &__row {
      position: relative;
      display: flex;
      gap: var(--group-gap);
      padding: 12px;
      overflow: auto;

      & > div {
         gap: 12px !important;
      }
   }
   &__row.dv-pan {
      cursor: grab;
      touch-action: pan-x;
      scrollbar-width: none;
      height: 100% !important;
      border-radius: 35px;
      flex: 1 1 auto !important;
   }
   &__row.dv-pan.is-dragging {
      cursor: grabbing;
   }
   &__row.dv-pan::-webkit-scrollbar {
      display: none;
   }

   &__track {
      display: flex;
      width: max-content;
      will-change: transform;
      transform: translateZ(0);
   }

   /* ---------- Day group ---------- */
   &__group-wrap {
      min-width: calc(var(--cols) * var(--colw));
      display: flex;
      flex-direction: column;
      gap: 12px;
      align-self: flex-start;
      flex: 0 0 auto;
      position: relative;
      overflow: visible;
      opacity: 0;
      transform: translateY(6px);
      transition: opacity 160ms ease, transform 160ms ease;
      will-change: opacity, transform;

      content-visibility: auto;
      contain-intrinsic-size: 44px 1400px;
      contain: layout paint size;
   }
   &__group-wrap[data-active="1"] {
      opacity: 1;
      transform: translateY(0);
   }

   &__block {
      content-visibility: auto;
      contain-intrinsic-size: 800px;
   }

   &__group-header {
      position: sticky;
      top: 0;
      z-index: 20;
      height: var(--day-header-h);
      display: flex;
      align-items: center;
      justify-content: center;
      height: auto !important;
   }
   &__group-title {
      padding: 6px 12px;
      background: var(--black-s);
      border-radius: 30px;
   }

   /* ---------- Conținut zi ---------- */
   &__group-content {
      display: grid;
   }
   &__group-content--row {
      grid-template-columns: 1fr !important;
   }

   &__columns {
      display: grid;
      gap: 6px;
      grid-template-columns: repeat(var(--cols), minmax(var(--colw), 1fr));
   }

   &__event-col {
      position: relative;
      min-height: calc(
         var(--row-header-h) + var(--visible-slots) * var(--slot-h)
      );
      background: var(--black-p);
      border-radius: 16px 16px 22px 22px;

      content-visibility: auto;
      contain-intrinsic-size: 48px 1600px;
      contain: layout paint;
   }
   &__event-col--pad {
      opacity: 0.35;
      pointer-events: none;
   }

   .dayview__column-head {
      height: var(--row-header-h);
      padding: 6px 8px;
      display: flex;
      flex-direction: column;
      align-content: start;
      width: 100%;
      overflow: hidden;
      z-index: 2;
   }
   .dv-inst-name {
      white-space: nowrap;
      width: 100%;
      overflow: hidden;
      text-overflow: ellipsis;
   }
   .dv-inst-plate {
      font-size: 10px;
      opacity: 0.8;
   }

   /* ---------- Card eveniment ---------- */
   &__event {
      position: absolute;
      left: 0;
      right: 0;
      padding: 8px;
      border: 3px solid var(--black-p);
      border-radius: 18px;
      background: var(--event-default);
      color: var(--white-p);
      font-size: 12px;
      display: flex;
      flex-direction: column;
      gap: 0px;
      overflow: hidden;
      top: calc(var(--row-header-h) + var(--ev-slots) * var(--slot-h));
      height: calc(var(--ev-span) * var(--slot-h));
      transition: var(--elastic-f);
      z-index: 100;
      &:active {
         transform: scale(0.95);
      }
   }
   &__event--virtual {
      width: 100%;
   }

   &__event--default {
      background: var(--event-default);
   }
   &__event--yellow {
      background: var(--event-yellow);
   }
   &__event--green {
      background: var(--event-green);
   }
   &__event--red {
      background: var(--event-red);
   }
   &__event--orange {
      background: var(--event-orange);
   }
   &__event--purple {
      background: var(--event-purple);
   }
   &__event--pink {
      background: var(--event-pink);
   }
   &__event--blue {
      background: var(--event-blue);
   }
   &__event--indigo {
      background: var(--event-indigo);
   }
   &__event-person-name {
      color: var(--white-p);
      font-weight: 500;
      white-space: nowrap;
      width: 100%;
      text-overflow: ellipsis;
      text-align: left;
   }
   &__event-note {
      width: 100%;
      flex: 1;
      padding-left: 2px;
      font-size: 10px;
      color: var(--white-s);
      display: flex;
      align-items: flex-start;
      text-overflow: ellipsis !important;
      width: 100%;
      overflow: hidden;
      text-overflow: ellipsis;
   }

   /* ---------- Meta pills ---------- */
   .dv-meta-row {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 3px;
      width: 100%;
   }
   .dv-meta-pill {
      font-size: 10px;
      padding: 2px 6px;
      border-radius: 99px;
      color: var(--white-p);
      background: var(--bd);
      user-select: none;
   }
}
@media only screen and (max-width: $mobile) {
   .dayview {
      &__header {
         display: flex;
         align-items: center;
         flex-direction: column;
         justify-content: space-between;
         gap: 6px;
         padding: 0 12px 12px 12px;
      }
   }
}
/* buton ascuns */
.dv-order-toggle {
   display: none !important;
}

/* pad mișcare */
.dv-move-pad {
   display: grid;
   grid-template-columns: repeat(3, 1fr);
   grid-template-rows: repeat(3, 1fr);
   gap: 3px;
   padding: 6px;
   z-index: 10;
}
.dv-move-pad button {
   width: 100%;
   height: 100%;
   background: var(--black-s);
   color: var(--white-p);
   border-radius: 16px;
   cursor: pointer;
   line-height: 0px;
   padding-bottom: 3px;
   transition: var(--elastic-f);
   &:active {
      scale: 0.95;
   }
}
.dv-move-pad button:disabled {
   opacity: 0.35;
   cursor: not-allowed;
   filter: saturate(0);
   &:active {
      scale: 1;
   }
}

/* font scaling cu zoom */
.dayview__group-title {
   font-size: calc(16px * var(--font-scale));
}
.dv-inst-name {
   font-size: calc(14px * var(--font-scale));
}
.dv-inst-plate {
   font-size: calc(12px * var(--font-scale));
}
.dayview__event {
   font-size: calc(13px * var(--font-scale));
}
.dv-meta-pill,
.dv-phone {
   font-size: calc(10px * var(--font-scale)) !important;
}
.dayview__event-note {
   font-size: calc(12px * var(--font-scale));
   line-height: 1.25;
}

/* ===========================================================
   Utils panning
   =========================================================== */
.dv-pan.is-panning,
.dv-pan.is-panning * {
   user-select: none !important;
   -webkit-user-select: none !important;
   -ms-user-select: none !important;
   -webkit-user-drag: none;
}
.dv-pan.is-panning {
   user-select: none;
   -webkit-user-select: none;
}

/* ===== Flow mode (fără absolute): o singură versiune ===== */
.dayview__event-col {
   min-height: 0 !important;
   display: grid;
   grid-template-columns: 1fr;
   user-select: none !important;
   /* header + sloturi egale (implicit controlate mai jos cu --slot-h-fixed) */
}

.dayview__list {
   display: flex;
   flex-direction: column;
   gap: 8px;
   padding: 8px;
}

.dayview__event {
   position: static !important;
   left: auto !important;
   right: auto !important;
   top: auto !important;
   height: auto !important;
   margin: 0;
   border-radius: 14px;
   border: 2px solid var(--black-p);
   padding: 8px;
   overflow: hidden;
}

.dv-slot {
   height: var(--event-h);
}

.dv-slot > .dayview__event {
   height: 100%;
   display: flex;
   flex-direction: column;
   box-sizing: border-box;
   overflow: hidden;
}

/* clamp notițe (o singură versiune) */
.dayview__event-note {
   overflow: hidden;
   display: -webkit-box;
   -webkit-line-clamp: 2;
   -webkit-box-orient: vertical;
}

/* Coloană cu header + sloturi egale (o singură versiune) */
.dayview__event-col {
   display: grid;
   grid-template-rows: var(--row-header-h) repeat(
         var(--visible-slots),
         var(--event-h)
      );
   gap: 8px;
}

/* === Unificare: slot fix cu zoom (o singură versiune) === */
:root {
   --card-h: 88px;
}
.dayview {
   --zoom: 1;
   --slot-h-fixed: calc(var(--card-h) * var(--zoom));
   --anim-zoom-ms: 260ms;
   .dv-scale {
      will-change: transform;
   }
}

.dayview .dayview__event {
   position: static !important;
   top: auto !important;
   left: auto !important;
   right: auto !important;
   height: 100% !important;
   min-height: 0 !important;
   margin: 0 !important;
   border-width: 2px !important;
   box-sizing: border-box !important;
   overflow: hidden !important;
}

.dayview .dayview__event-col {
   min-height: 0 !important;
   display: grid !important;
   grid-template-rows: var(--row-header-h) !important;
   grid-auto-rows: var(--slot-h-fixed) !important;
   gap: 0px !important;
}

.dayview .dv-slot {
   height: auto !important;
}

.dayview .dayview__event-note {
   overflow: hidden !important;
   display: -webkit-box !important;
   -webkit-line-clamp: 2 !important;
   -webkit-box-orient: vertical !important;
}

/* grilă sortabilă */
.dv-sortable-grid {
   display: grid;
   grid-template-columns: repeat(var(--cols, 3), calc(var(--colw)));
   gap: 0;
}

/* drag handle / head – o singură definiție */
.dv-drag-head {
   cursor: grab;
   user-select: none;
}
.dv-drag-head:active {
   cursor: grabbing;
}

.dv-pan.is-dnd-active {
   cursor: default;
}

/* dezactivează optimizările care pot masca click-ul în timpul DnD */
.dayview__group-wrap,
.dayview__columns,
.dayview__event-col {
   content-visibility: visible !important;
   contain: none !important;
}

.dv-drag-handle {
   position: absolute;
   top: 10px;
   left: 30%;
   height: 4px;
   border-radius: 6px;
   cursor: grab;
   touch-action: none;
   opacity: 0.7;
   background: var(--white-t);
   width: 40%;
}
.dv-drag-handle:active {
   background: var(--accent-d);
   cursor: grabbing;
   opacity: 1;
}

/* previne săriturile când intră/iese conținutul */
.dayview__row.dv-pan,
.dayview__group-wrap {
   overflow-anchor: none;
}

/* scrollbar stabil */
.dayview__row.dv-pan {
   scrollbar-gutter: stable both-edges;
}

/* mască margini pentru intrare/ieșire sloturi */
.dayview__row.dv-pan {
   -webkit-mask-image: linear-gradient(
      to right,
      transparent 0,
      black 16px,
      black calc(100% - 16px),
      transparent 100%
   );
   mask-image: linear-gradient(
      to right,
      transparent 0,
      black 16px,
      black calc(100% - 16px),
      transparent 100%
   );
}

/* === FIX: cardurile trebuie să fie clicabile pe desktop (o singură versiune) === */
.dv-pan:not(.is-panning) .dayview__event,
.dv-pan:not(.is-panning) .dayview__event * {
   pointer-events: auto !important;
}
.dv-pan .dayview__event {
   pointer-events: auto;
}
.dayview__row.dv-pan {
   touch-action: pan-x;
   cursor: grab;
}
.dv-slot--skeleton::before {
   content: "";
   display: block;
   height: 70%;
   margin: 6px 8px;
   border-radius: 8px;
   background: linear-gradient(90deg, #eee 25%, #f6f6f6 37%, #eee 63%);
   background-size: 400% 100%;
   animation: dv-shimmer 1.2s ease-in-out infinite;
}
@keyframes dv-shimmer {
   0% {
      background-position: 100% 0;
   }
   100% {
      background-position: 0 0;
   }
}
