:root {
   /* Dimensiuni/layout */
   --slot-h: 30px; /* înălțime slot (override prin props.layout.slotHeight) */
   --hours-col-w: 160px; /* lățimea coloanei cu ore */
   --group-gap: 12px; /* spațiu între grupe */
   --cols: 1;
   --colw: 120px; /* poate fi px sau % (override prin props.layout.colWidth) */

   /* Culori evenimente (tema light) */
   --event-default: var(--accent-t);
   --event-red: hsl(0 70% 40%);
   --event-orange: hsl(30 70% 40%);
   --event-yellow: hsl(54 100% 33%);
   --event-green: hsl(130 70% 23%);
   --event-blue: hsl(210 70% 40%);
   --event-indigo: hsl(255 70% 33%);
   --event-purple: hsl(285 66% 32%);
   --event-pink: hsl(330 68% 38%);
}

.darkmode {
   /* Culori evenimente (tema dark) */
   --event-default: var(--accent-t);
   --event-red: hsl(0 100% 87%);
   --event-orange: hsl(30 100% 80%);
   --event-yellow: hsl(54 95% 76%);
   --event-green: hsl(130 65% 76%);
   --event-blue: hsl(210 90% 74%);
   --event-indigo: hsl(255 98% 83%);
   --event-purple: hsl(285 100% 84%);
   --event-pink: hsl(330 96% 81%);
}

/* ===========================================================
   DAYVIEW
   =========================================================== */
.dayview {
   display: flex;
   flex-direction: column;
   height: 100%; /* poate fi suprascris din props.layout.containerHeight */
   background: var(--black-s);
   color: var(--white-p);

   /* ---------------- Header + Toolbar ---------------- */
   &__header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 0 12px;
   }

   &__header-left {
      min-width: 250px;
   }

   &__toolbar {
      display: flex;
      align-items: center;
      gap: 6px;
      height: 100%;

      .dv-search {
         position: relative;

         &__input {
            width: 100%;
            height: 100%;
            padding: 12px 16px;
            border-radius: 32px;
            background: var(--black-p);
            color: var(--white-p);
            font-size: 14px;
            outline: none;

            &::placeholder {
               color: var(--muted);
            }
         }
      }

      .dv-btn {
         height: 100%;
         padding: 13px 13px;
         border-radius: 18px;
         background: var(--black-p);
         color: var(--white-p);
         transition: all var(--elastic-f), background var(--classic-f);
         font-size: 14px;
         cursor: pointer;
         &:hover {
            border-radius: 10px;
            background: var(--accent-l);
            color: var(--accent-d);
         }
         &:active {
            border-radius: 18px;
            scale: 0.92;
         }
         &--ghost {
            padding: 12px 16px;
            border-radius: 10px;
            pointer-events: none;
         }
      }
   }

   /* ---------------- Canvas / Row (drag-pan) ---------------- */
   &__row {
      display: flex;
      align-items: flex-start;
      gap: var(--group-gap);
      padding: 12px;
      overflow: auto;

      &.dv-pan {
         position: relative;
         cursor: grab;
         touch-action: none; /* gestionăm manual gesturile */
         scrollbar-width: none;

         /* fade pe margini */
         --fade: 16px;
         mask-image: linear-gradient(
               to right,
               transparent 0,
               #000 var(--fade),
               #000 calc(100% - var(--fade)),
               transparent 100%
            ),
            linear-gradient(
               to bottom,
               transparent 0,
               #000 var(--fade),
               #000 calc(100% - var(--fade)),
               transparent 100%
            );
         mask-composite: intersect;

         -webkit-mask-image: linear-gradient(
               to right,
               transparent,
               #000 var(--fade),
               #000 calc(100% - var(--fade)),
               transparent
            ),
            linear-gradient(
               to bottom,
               transparent,
               #000 var(--fade),
               #000 calc(100% - var(--fade)),
               transparent
            );
         -webkit-mask-composite: source-in;

         &::-webkit-scrollbar {
            display: none;
         }

         &.is-panning,
         &.is-dragging {
            user-select: none;
            -webkit-user-select: none;
            -ms-user-select: none;
            -webkit-user-drag: none;
         }

         &.is-dragging {
            cursor: grabbing;
         }

         /* opțional: în timp ce panning, ignoră highlight-ul ca țintă */
         &.is-panning .highlight {
            pointer-events: none;
         }
      }
   }

   /* ---------------- Group wrapper ---------------- */
   &__group-wrap {
      min-width: calc(var(--hours-col-w) + var(--cols) * var(--colw));
      align-self: flex-start; /* forțează înălțimea după conținut */
      background: var(--black-p);
      border-radius: 16px 16px 22px 22px;
   }

   &__group-header {
      display: grid;
      grid-template-columns: var(--hours-col-w) 1fr;
      align-items: stretch;

      .dayview__group-name {
         padding: 8px 10px;
         font-weight: 700;
         overflow: hidden;
         text-overflow: ellipsis !important;
         border-right: 1px solid var(--bd);
      }

      .dayview__group-instructors {
         display: grid !important;
         width: 100%;
         grid-template-columns: repeat(var(--cols), 1fr);
      }

      /* reset mic pt. titluri în header */
      h1,
      h2,
      h3,
      p {
         margin: 0;
         color: var(--white-t);
      }
   }

   &__instructor-head {
      padding: 6px;
      text-align: center;
      font-weight: 600;
      font-size: 12px;

      .dv-inst-name {
         white-space: nowrap;
         overflow: hidden;
         text-overflow: ellipsis;
      }

      .dv-inst-plate {
         font-size: 10px;
         opacity: 0.8;
      }
   }

   /* ---------------- Group content: ore + coloane ---------------- */
   &__group-content {
      display: grid;
      grid-template-columns: var(--hours-col-w) 1fr;
      margin-bottom: 0;
   }

   &__hours {
      position: relative;
      min-height: calc(var(--visible-slots) * var(--slot-h));
      border-right: 1px solid var(--bd);

      .dayview__hour-mark {
         position: absolute;
         top: calc(var(--mark-slots) * var(--slot-h));
         left: 0;
         width: 100%;
         padding: 0 6px;
         text-align: center;
         font-size: 12px;
         color: var(--muted);
         pointer-events: none;
      }
   }

   &__columns {
      display: grid;
      grid-template-columns: repeat(var(--cols), minmax(var(--colw), 1fr));
   }

   &__event-col {
      position: relative;
      min-height: calc(var(--visible-slots) * var(--slot-h));
      border-left: 1px solid var(--bd);
      display: grid; /* pentru liniile de slot */
      grid-template-rows: repeat(var(--visible-slots), var(--slot-h));

      &:first-child {
         border-left: none;
      }

      .dayview__slot-line {
         height: var(--slot-h);
         display: none; /* ascuns, păstrat pt. compat */
      }

      /* linii oră majoră */
      .dayview__mark-line {
         position: absolute;
         left: 0;
         right: 0;
         top: calc(var(--mark-slots) * var(--slot-h));
         height: 0;
         border-top: 1px solid var(--bd);
         z-index: 10000;
         pointer-events: none;
      }
   }

   /* ---------------- Eveniment (card) ---------------- */
   &__event {
      position: absolute;
      left: 0;
      right: 0;
      padding: 8px;
      border: 3px solid var(--black-p);
      border-radius: 18px;
      background: var(--event-default);
      color: var(--white-p);
      font-size: 12px;
      display: flex;
      flex-direction: column;
      gap: 4px;
      overflow: hidden;

      /* Pozitionare pe baza JS: --ev-slots (start), --ev-span (durata in sloturi) */
      top: calc(var(--ev-slots) * var(--slot-h));
      height: calc(var(--ev-span) * var(--slot-h));

      &--virtual {
         width: 100%;
      }

      /* variante culoare */
      &--default {
         background: var(--event-default);
      }
      &--yellow {
         background: var(--event-yellow);
      }
      &--green {
         background: var(--event-green);
      }
      &--red {
         background: var(--event-red);
      }
      &--orange {
         background: var(--event-orange);
      }
      &--purple {
         background: var(--event-purple);
      }
      &--pink {
         background: var(--event-pink);
      }
      &--blue {
         background: var(--event-blue);
      }
      &--indigo {
         background: var(--event-indigo);
      }

      &-top {
         display: flex;
         align-items: center;
         justify-content: space-between;
         gap: 8px;
         padding: 0 0 0 2px;
      }

      &-person {
         display: flex;
         align-items: center;
         gap: 8px;
         min-width: 0;

         &-name {
            color: var(--white-p);
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
         }
      }

      &-note {
         width: 100%;
         flex: 1;
         padding: 0 0 0 2px;
         font-size: 10px;
         color: var(--white-s);
         display: flex;
         align-items: flex-start;
         justify-content: flex-start;
         text-overflow: ellipsis !important;
      }
   }

   /* ---------------- Meta pills ---------------- */
   .dv-meta-row {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 3px;
      width: 100%;

      .dv-meta-pill {
         font-size: 10px;
         padding: 2px 6px;
         border-radius: 99px;
         color: var(--white-p);
         background: var(--bd);
      }
   }

   /* ---------------- Selector culoare (în card) ---------------- */
   &__color-trigger {
      border: none;
      background: transparent;
      padding: 0;
      margin: 0;
      height: 100%;
      cursor: pointer;

      .dayview__color-dot {
         width: 14px;
         height: 14px;
         display: inline-block;
         border-radius: 50%;
         background: var(--white-p);
      }
   }

   &__color-overlay {
      display: grid;
      height: 100%;
      z-index: 20;

      .dayview__color-grid {
         position: absolute;
         inset: 0;
         display: grid;
         width: 100%;
         height: 100%;
         padding: 3px;
         background: var(--accent-l);
         grid-template-columns: repeat(3, 1fr);
         grid-template-rows: repeat(3, 1fr);
         gap: 3px;
         z-index: 21;

         .dayview__color-cell,
         .dayview__color-close {
            display: grid;
            place-items: center;
            border-radius: 12px;
            cursor: pointer;
            z-index: 10;
         }

         .dayview__color-cell {
            &--yellow {
               background: var(--event-yellow);
            }
            &--green {
               background: var(--event-green);
            }
            &--red {
               background: var(--event-red);
            }
            &--orange {
               background: var(--event-orange);
            }
            &--purple {
               background: var(--event-purple);
            }
            &--pink {
               background: var(--event-pink);
            }
            &--blue {
               background: var(--event-blue);
            }
            &--indigo {
               background: var(--event-indigo);
            }
         }

         .dayview__color-close {
            position: relative;
            font-size: 28px;
            font-weight: 300;
            line-height: 1;

            &-icon {
               position: absolute;
               inset: 0;
               display: flex;
               align-items: center;
               justify-content: center;
               color: var(--black-s);

               svg {
                  rotate: 45deg;
               }
            }
         }
      }
   }
}

/* ===========================================================
   Utils panning (evită selecția în timpul dragului)
   =========================================================== */
.dv-pan.is-panning,
.dv-pan.is-panning * {
   user-select: none !important;
   -webkit-user-select: none !important;
   -ms-user-select: none !important;
   -webkit-user-drag: none;
}

/* ===========================================================
   Swap controls + animații
   =========================================================== */
.dv-swap-controls {
   display: inline-flex;
   align-items: center;
   gap: 4px;
   padding: 4px;
}

.dv-swap-btn {
   position: relative;
   display: flex;
   align-items: center;
   justify-content: center;
   height: 100%;
   padding: 10px 14px;
   border-radius: 14px;
   background: var(--black-s);
   color: var(--white-p);
   font-size: 24px;
   line-height: 0;
   cursor: pointer;
   transition: all var(--elastic-f), background var(--classic-f);

   &:disabled {
      opacity: 0.4;
      cursor: not-allowed;
   }
   &:not(:disabled):hover {
      background: var(--accent-l);
      color: var(--accent-d);
   }
   &:hover {
      border-radius: 10px;
   }
   &:active {
      border-radius: 14px;
      scale: 0.92;
   }
}

.dv-swap-icon {
   padding: 0;
   position: absolute;

   svg {
      width: 28px;
      height: 28px;
   }
   &.rotate180 svg {
      rotate: 180deg;
   }
}

.dv-swap-anim {
   will-change: transform, opacity;
}
.dv-swap-anim--left {
   animation: dv-slide-left 0.3s ease both;
}
.dv-swap-anim--right {
   animation: dv-slide-right 0.3s ease both;
}

@keyframes dv-slide-left {
   from {
      transform: translateX(0);
   }
   to {
      transform: translateX(calc(-100% - 16px));
   }
}
@keyframes dv-slide-right {
   from {
      transform: translateX(0);
   }
   to {
      transform: translateX(calc(100% + 16px));
   }
}
